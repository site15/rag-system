# Документация генератора таблиц фронтенда

## Обзор

Генератор таблиц фронтенда автоматически создает компоненты списков React Admin из моделей схемы Prisma. Эти компоненты обеспечивают комплексное отображение данных с автоматическим определением типов полей и соответствующими компонентами отображения.

## Генерируемые компоненты

Для каждой модели Prisma генератор создает:
- `ModelNameList.tsx` - Компонент представления таблицы со всеми соответствующими полями
- `ModelNameForm.tsx` - Компонент формы для создания/редактирования записей  
- `ModelDataProvider.ts` - Провайдер данных для интеграции с API

## Автоматическая обработка полей

Генератор автоматически определяет типы полей и применяет соответствующие компоненты отображения:

### Скалярные поля
- **Строковые/текстовые поля**: Стандартные столбцы таблицы с опциональным усечением для длинного контента
- **Числовые поля** (Int, Float, Decimal): Столбцы с числами с надлежащим форматированием
- **Булевые поля**: Отображение флажков с использованием компонента BooleanField
- **Поля JSON**: Интерактивный просмотрщик JSON с использованием react-json-view
- **Поля DateTime**: Форматированное отображение даты со временем с использованием компонента DateField

### Специальная обработка полей

#### Поля дат
Все поля `createdAt` автоматически включаются в представления списков с надлежащим форматированием даты/времени:
```tsx
<DataTable.Col source={Prisma.ModelNameScalarFieldEnum.createdAt}>
  <DateField source={Prisma.ModelNameScalarFieldEnum.createdAt} showTime />
</DataTable.Col>
```

Генератор исключает поля `updatedAt` из отображения списков по умолчанию, поскольку они обычно менее актуальны для потребления конечным пользователем.

#### Поля с длинным текстом
Поля, сопоставленные с типами TEXT базы данных, автоматически получают стилизацию с многоточием:
```tsx
<DataTable.Col 
  source={Prisma.ModelNameScalarFieldEnum.longTextField}
  sx={{
    display: 'inline-block',
    maxWidth: '200px',
    overflow: 'hidden',
    textOverflow: 'ellipsis',
    whiteSpace: 'nowrap',
  }}
/>
```

## Пример сгенерированного компонента

Вот пример сгенерированного компонента списка для модели ChatDialog:

```tsx
import {
  DataTable,
  DeleteButton,
  EditButton,
  List,
  BooleanField,
  DateField,
} from 'react-admin';
import { Prisma } from '../prisma/browser';

import ReactJson from 'react-json-view';
import { useRecordContext } from 'react-admin';

const JsonViewerField = ({ source }) => {
  const record = useRecordContext();
  if (!record || !record[source]) return null;
  return (
    <ReactJson
      src={record[source]}
      collapsed={true}
      theme="monokai"
      displayDataTypes={false}
    />
  );
};

export const ChatDialogList = () => (
  <List>
    <DataTable>
      <DataTable.Col source={Prisma.ChatDialogScalarFieldEnum.id} />
      <DataTable.Col source={Prisma.ChatDialogScalarFieldEnum.userId} />
      <DataTable.Col source={Prisma.ChatDialogScalarFieldEnum.title} />
      <DataTable.Col
        source={Prisma.ChatDialogScalarFieldEnum.summary}
        sx={{
          display: 'inline-block',
          maxWidth: '200px',
          overflow: 'hidden',
          textOverflow: 'ellipsis',
          whiteSpace: 'nowrap',
        }}
      />
      <DataTable.NumberCol
        source={Prisma.ChatDialogScalarFieldEnum.consecutiveFailures}
      />
      <DataTable.Col source={Prisma.ChatDialogScalarFieldEnum.isFailed}>
        <BooleanField source={Prisma.ChatDialogScalarFieldEnum.isFailed} />
      </DataTable.Col>
      <DataTable.Col source={Prisma.ChatDialogScalarFieldEnum.createdAt}>
        <DateField
          source={Prisma.ChatDialogScalarFieldEnum.createdAt}
          showTime
        />
      </DataTable.Col>
      <EditButton />
      <DeleteButton />
    </DataTable>
  </List>
);
```

## Опции кастомизации

Хотя генератор предоставляет разумные значения по умолчанию, вы можете кастомизировать сгенерированные компоненты следующими способами:

1. **Ручные модификации**: Прямое редактирование сгенерированных файлов `.tsx`
2. **Настройки стилей**: Модификация свойств sx для стилизации столбцов
3. **Переопределение компонентов**: Замена компонентов полей по умолчанию на пользовательские
4. **Порядок столбцов**: Перестановка элементов DataTable.Col для изменения порядка отображения

## Процесс регенерации

Для регенерации компонентов после изменений схемы Prisma:
```bash
cd backend
npx prisma generate
```

Это обновит все сгенерированные компоненты фронтенда в соответствии с текущей структурой схемы, включая любые новые поля или изменения типов.

## Логика выбора полей

Генератор включает следующие поля в представления списков:
- Все скалярные поля, кроме `updatedAt`
- Автоматическое форматирование полей на основе их типов Prisma
- Применение соответствующих компонентов React Admin для оптимального отображения

Поля, исключенные из представлений списков:
- `updatedAt` - обычно не полезны для отображения конечному пользователю
- Поля отношений - обрабатываются отдельно в подробных представлениях